<div class="notification-wrapper">
  <!-- Notification Bell Button -->
  <button class="notification-bell" (click)="togglePanel()" [class.has-unread]="unreadCount > 0" [attr.aria-label]="'Notifications ' + unreadCount">
    <div class="bell-icon-container">
      <svg class="bell-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <span class="bell-shine"></span>
    </div>
    <span class="unread-badge" *ngIf="unreadCount > 0">
      <span class="badge-number">{{ unreadCount > 99 ? '99+' : unreadCount }}</span>
    </span>
  </button>

  <!-- Notification Panel -->
  <div class="notification-panel" *ngIf="isOpen" [@slideDown]>
    <div class="panel-header">
      <div class="header-title">
        <h3>Notifications</h3>
        <span class="notification-count" *ngIf="unreadCount > 0">{{ unreadCount }} new</span>
      </div>
      <button class="btn-mark-all" *ngIf="unreadCount > 0" (click)="markAllAsRead()">
        Mark all read
      </button>
    </div>

    <div class="notifications-list" (scroll)="onNotificationListScroll($event)">
      <div
        class="notification-item"
        *ngFor="let notification of notifications"
        [class.unread]="!notification.read"
        [class]="getPriorityClass(notification.priority)"
        (click)="handleNotificationClick(notification)">

        <div class="notification-icon">
          {{ getNotificationIcon(notification) }}
        </div>

        <div class="notification-content">
          <div class="notification-header">
            <div class="notification-title-wrapper">
              <span class="notification-title">{{ notification.title }}</span>
              <span class="notification-badge" *ngIf="notification.priority === 'high'">Important</span>
            </div>
            <span class="notification-time">{{ formatTime(notification.timestamp) }}</span>
          </div>
          <p class="notification-message">{{ notification.message }}</p>
          <button
            class="notification-action"
            *ngIf="notification.actionLabel && !notification.read"
            (click)="onNotificationAction(notification, $event)">
            {{ notification.actionLabel }} â†’
          </button>
        </div>

        <div class="notification-actions">
          <button
            class="btn-icon"
            *ngIf="!notification.read"
            (click)="markAsRead(notification, $event)"
            title="Mark as read">
            âœ“
          </button>
        </div>
      </div>

      <div class="empty-state" *ngIf="notifications.length === 0">
        <div class="empty-icon">ðŸ”•</div>
        <p class="empty-message">No notifications</p>
      </div>

      <!-- Load more indicator -->
      <div class="load-more-indicator" *ngIf="notifications.length < allNotifications.length">
        <p>Scroll for more notifications ({{ notifications.length }} of {{ allNotifications.length }})</p>
      </div>
    </div>

    <div class="panel-footer">
      <button class="btn-view-all" (click)="closePanel()">
        View All Notifications
      </button>
    </div>
  </div>

  <!-- Backdrop -->
  <div class="notification-backdrop" *ngIf="isOpen" (click)="closePanel()"></div>
</div>
