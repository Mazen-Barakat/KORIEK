<!-- Appointment Confirmation Dialog -->
<div class="dialog-overlay" *ngIf="isVisible" (click)="$event.stopPropagation()">
  <div class="dialog-container" [class.expired]="isExpired">
    <!-- Header -->
    <div class="dialog-header">
      <div class="header-icon" [class.expired-icon]="isExpired">
        <svg *ngIf="!isExpired" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
        <svg *ngIf="isExpired" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <line x1="15" y1="9" x2="9" y2="15"/>
          <line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
      </div>
      <h2 class="dialog-title">{{ currentNotification?.title || 'Confirm Your Appointment' }}</h2>
    </div>

    <!-- Timer -->
    <div class="timer-container" [class.timer-expired]="isExpired">
      <div class="timer-label">Time Remaining</div>
      <div class="timer-value">{{ remainingTime }}</div>
    </div>

    <!-- Message -->
    <div class="dialog-message">
      <p>{{ currentNotification?.message }}</p>
    </div>

    <!-- Warning Info Box -->
    <div class="info-box">
      <svg class="info-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="16" x2="12" y2="12"/>
        <line x1="12" y1="8" x2="12.01" y2="8"/>
      </svg>
      <span class="info-text">
        Both you and the other party must confirm for the appointment to proceed.
        <span *ngIf="isExpired" class="expired-warning">
          <br><strong>The confirmation deadline has passed.</strong>
        </span>
      </span>
    </div>

    <!-- Action Buttons -->
    <div class="dialog-actions">
      <button
        class="btn btn-confirm"
        [disabled]="isExpired || isConfirming || isDeclining"
        [class.loading]="isConfirming"
        (click)="confirmAppointment()">
        <span *ngIf="!isConfirming" class="btn-content">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          Confirm Arrival
        </span>
        <span *ngIf="isConfirming" class="btn-content">
          <div class="spinner"></div>
          Confirming...
        </span>
      </button>

      <button
        class="btn btn-decline"
        [disabled]="isExpired || isConfirming || isDeclining"
        [class.loading]="isDeclining"
        (click)="declineAppointment()">
        <span *ngIf="!isDeclining" class="btn-content">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Decline
        </span>
        <span *ngIf="isDeclining" class="btn-content">
          <div class="spinner"></div>
          Declining...
        </span>
      </button>
    </div>

    <!-- Close button for expired state -->
    <button *ngIf="isExpired" class="btn-close-expired" (click)="closeDialog()">
      Close
    </button>
  </div>
</div>
