<div class="car-details-page">
  <div class="header-section">
    <button class="back-btn" (click)="goBack()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="16" height="16">
        <path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/>
      </svg>
    </button>
    <div class="title-section">
      <h1>{{ vehicle?.year }} {{ vehicle?.make }} {{ vehicle?.model }}</h1>
      <p class="license-plate">{{ vehicle?.licensePlate }}</p>
    </div>
    <button class="edit-btn" (click)="editCarAndIndicators()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="16" height="16">
        <path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"/>
      </svg>
      Edit Car and Indicators
    </button>
  </div>

  <div class="content-grid" *ngIf="vehicle">
    <!-- Left Column: Car Image and Vehicle Information -->
    <div class="left-column">
      <!-- Car Image with placeholder until loaded -->
      <div class="car-image-section">
        <div class="car-placeholder" *ngIf="!imageLoaded || imageError">
          <!-- simple inline SVG placeholder -->
          <svg width="120" height="80" viewBox="0 0 120 80" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <rect width="120" height="80" rx="8" fill="#f3f4f6"/>
            <g fill="#d1d5db">
              <path d="M10 60c0-8 10-18 30-18s30 10 40 10 20-6 30-6v24H10V60z"/>
            </g>
          </svg>
        </div>

        <img [src]="vehicle.imageUrl" [alt]="vehicle.year + ' ' + vehicle.make + ' ' + vehicle.model" class="car-image" (load)="onImageLoad()" (error)="onImageError()" [class.hidden]="!imageLoaded || imageError">
      </div>

      <!-- Vehicle Information (vertical list) -->
      <div class="vehicle-info-section vertical-list">
        <h2>Vehicle Information</h2>
        <div class="info-list">
          <div class="info-row">
            <label>Make</label>
            <p>{{ vehicle.make }}</p>
          </div>
          <div class="info-row">
            <label>Model</label>
            <p>{{ vehicle.model }}</p>
          </div>
          <div class="info-row">
            <label>Year</label>
            <p>{{ vehicle.year }}</p>
          </div>
          <div class="info-row">
            <label>Color</label>
            <p>{{ vehicle.color }}</p>
          </div>
          <div class="info-row">
            <label>License Plate</label>
            <p>{{ vehicle.licensePlate }}</p>
          </div>
          <div class="info-row">
            <label>VIN</label>
            <p>{{ vehicle.vin }}</p>
          </div>
          <div class="info-row">
            <label>Engine Type</label>
            <p>{{ vehicle.engineType }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Maintenance Information and Condition Indicators -->
    <div class="right-column">
      <!-- Maintenance Information -->
      <div class="maintenance-info-section">
        <div class="section-header">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20">
            <path d="M78.6 5C69.1-2.4 55.6-1.5 47 7L7 47c-8.5 8.5-9.4 22-2.1 31.6l80 104c4.5 5.9 11.6 9.4 19 9.4h54.1l109 109c-14.7 29-10 65.4 14.3 89.6l112 112c12.5 12.5 32.8 12.5 45.3 0l64-64c12.5-12.5 12.5-32.8 0-45.3l-112-112c-24.2-24.2-60.6-29-89.6-14.3l-109-109V104c0-7.5-3.5-14.5-9.4-19L78.6 5zM19.9 396.1C7.2 408.8 0 426.1 0 444.1C0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9L233.7 374.3c-7.8-20.9-9-43.6-3.6-65.1l-61.7-61.7L19.9 396.1zM512 144c0-10.5-1.1-20.7-3.2-30.5c-2.4-11.2-16.1-14.1-24.2-6l-63.9 63.9c-3 3-7.1 4.7-11.3 4.7H352c-8.8 0-16-7.2-16-16V102.6c0-4.2 1.7-8.3 4.7-11.3l63.9-63.9c8.1-8.1 5.2-21.8-6-24.2C388.7 1.1 378.5 0 368 0C288.5 0 224 64.5 224 144l0 .8 85.3 85.3c36-9.1 75.8 .5 104 28.7L429 274.5c49-23 83-72.8 83-130.5zM56 432a24 24 0 1 1 48 0 24 24 0 1 1 -48 0z"/>
          </svg>
          <span>Maintenance Information</span>
        </div>
        <div class="maintenance-details">
          <div class="detail-item">
            <label>Current Mileage</label>
            <p class="highlight">{{ vehicle.currentMileage | number }} km</p>
          </div>
          <div class="detail-item">
            <label>Last Maintenance Date</label>
            <p>ðŸ“… {{ vehicle.lastMaintenanceDate }}</p>
          </div>
          <div class="maintenance-next">
            <div class="next-item">
              <label>Next Maintenance Date</label>
              <p class="date-highlight">ðŸ“… {{ vehicle.nextMaintenanceDate }}</p>
              <span class="badge">In 9 days</span>
            </div>
            <div class="next-item">
              <label>Next Maintenance Mileage</label>
              <p class="mileage-highlight">{{ vehicle.nextMaintenanceMileage | number }} km</p>
              <span class="badge-km">5,000 km remaining</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Condition Indicators -->
      <div class="condition-indicators-section">
        <h2>Condition Indicators</h2>
        <p class="subtitle">Monitor all maintenance indicators for your vehicle</p>
        <div class="indicators-grid">
          <div *ngFor="let indicator of vehicle.conditionIndicators" 
               class="indicator-card" 
               [ngClass]="getStatusClass(indicator.status)">
            <div class="indicator-header">
              <div class="indicator-title">
                <span class="indicator-icon">{{ indicator.icon }}</span>
                <span class="indicator-name">{{ indicator.name }}</span>
              </div>
              <div class="status-badge" [ngClass]="getStatusClass(indicator.status)">
                <svg *ngIf="indicator.status === 'Good'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="12" height="12">
                  <path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"/>
                </svg>
                <svg *ngIf="indicator.status === 'Attention'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="12" height="12">
                  <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/>
                </svg>
                <svg *ngIf="indicator.status === 'Urgent'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="12" height="12">
                  <path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/>
                </svg>
                {{ indicator.status }}
              </div>
            </div>
            <div class="indicator-details">
              <div class="detail-row">
                <span class="label">Last Inspection Date</span>
                <span class="value">{{ indicator.lastInspectionDate }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Next Inspection Date</span>
                <span class="value">{{ indicator.nextInspectionDate }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Next Mileage</span>
                <span class="value">{{ indicator.nextMileage | number }} km</span>
              </div>
              <div class="remaining-section">
                <span class="label">Remaining</span>
                <span class="remaining-value">{{ indicator.remaining | number }} km</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
