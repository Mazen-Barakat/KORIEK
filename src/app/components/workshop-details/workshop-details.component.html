<div class="workshop-details-page">
  <!-- Loading State with Skeleton -->
  <div class="loading-skeleton" *ngIf="isLoading">
    <div class="skeleton-hero"></div>
    <div class="skeleton-content">
      <div class="skeleton-header-card">
        <div class="skeleton-avatar"></div>
        <div class="skeleton-info">
          <div class="skeleton-title"></div>
          <div class="skeleton-meta"></div>
          <div class="skeleton-rating"></div>
        </div>
      </div>
      <div class="skeleton-tabs"></div>
      <div class="skeleton-grid">
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="!isLoading && errorMessage">
    <div class="error-content">
      <div class="error-icon">
        <svg
          width="64"
          height="64"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
        >
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="8" x2="12" y2="12" />
          <line x1="12" y1="16" x2="12.01" y2="16" />
        </svg>
      </div>
      <h2>Oops! Something went wrong</h2>
      <p>{{ errorMessage }}</p>
      <div class="error-actions">
        <button class="btn-retry" (click)="loadWorkshopDetails()">
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
            <path d="M3 3v5h5" />
          </svg>
          Try Again
        </button>
        <button class="btn-back" (click)="goBack()">
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M19 12H5" />
            <path d="m12 19-7-7 7-7" />
          </svg>
          Go Back
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="workshop-content" *ngIf="!isLoading && workshop && !errorMessage">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-background">
        <img
          [src]="currentHeroImage || workshop.coverImageUrl"
          [alt]="workshop.name"
          class="hero-image"
        />
        <div class="hero-gradient"></div>
      </div>

      <!-- Navigation -->
      <div class="hero-nav">
        <button class="nav-btn back-btn" (click)="goBack()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M19 12H5" />
            <path d="m12 19-7-7 7-7" />
          </svg>
          <span class="btn-text">Back</span>
        </button>

        <div class="hero-actions">
          <button class="nav-btn" (click)="shareWorkshop()" title="Share">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="18" cy="5" r="3" />
              <circle cx="6" cy="12" r="3" />
              <circle cx="18" cy="19" r="3" />
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" />
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
            </svg>
          </button>
          <button
            class="nav-btn"
            [class.favorited]="isFavorited"
            (click)="toggleFavorite()"
            title="Save"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              [attr.fill]="isFavorited ? '#e63946' : 'none'"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Status Badge -->
      <div class="hero-status" [class.open]="workshop.isOpen" [class.closed]="!workshop.isOpen">
        <span class="status-pulse"></span>
        <span class="status-text">{{ workshop.isOpen ? 'Open Now' : 'Closed' }}</span>
      </div>
    </section>

    <!-- Workshop Profile Card -->
    <section class="profile-section">
      <div class="profile-card">
        <div class="profile-header">
          <!-- Workshop Logo -->
          <div class="workshop-logo">
            <img
              *ngIf="workshop.logoImageUrl"
              [src]="workshop.logoImageUrl"
              [alt]="workshop.name"
            />
            <div *ngIf="!workshop.logoImageUrl" class="logo-placeholder">
              <span>{{ getInitials(workshop.name) }}</span>
            </div>
            <div
              class="verified-badge"
              *ngIf="workshop.verificationStatus === 'Verified'"
              title="Verified Workshop"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="#ffffff">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
          </div>

          <!-- Workshop Info -->
          <div class="workshop-info">
            <div class="info-main">
              <h1 class="workshop-name">{{ workshop.name }}</h1>
              <div class="workshop-badges">
                <span class="badge type-badge">{{
                  formatWorkshopType(workshop.workShopType)
                }}</span>
                <span
                  class="badge verified-badge-sm"
                  *ngIf="workshop.verificationStatus === 'Verified'"
                  >Verified</span
                >
              </div>
            </div>

            <!-- Rating Section -->
            <div class="rating-section">
              <div class="rating-stars">
                <ng-container *ngFor="let star of getStarArray(workshop.rating)">
                  <svg
                    *ngIf="star === 1"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="#fbbf24"
                    stroke="#fbbf24"
                    stroke-width="1"
                  >
                    <path
                      d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                    />
                  </svg>
                  <svg
                    *ngIf="star === 0.5"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    stroke="#fbbf24"
                    stroke-width="1"
                  >
                    <defs>
                      <linearGradient [id]="'halfStar' + workshop.id">
                        <stop offset="50%" stop-color="#fbbf24" />
                        <stop offset="50%" stop-color="transparent" />
                      </linearGradient>
                    </defs>
                    <path
                      [attr.fill]="'url(#halfStar' + workshop.id + ')'"
                      d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                    />
                  </svg>
                  <svg
                    *ngIf="star === 0"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="#fbbf24"
                    stroke-width="1"
                  >
                    <path
                      d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                    />
                  </svg>
                </ng-container>
              </div>
              <span class="rating-value">{{ workshop.rating.toFixed(1) }}</span>
              <span class="rating-count">({{ workshop.reviewCount }} reviews)</span>
            </div>

            <!-- Location Preview -->
            <div class="location-preview">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                <circle cx="12" cy="10" r="3" />
              </svg>
              <span>{{ workshop.city }}, {{ workshop.governorate }}</span>
              <span class="distance-tag" *ngIf="workshop.distance && workshop.distance < 999">
                {{ formatDistance(workshop.distance) }} away
              </span>
            </div>
          </div>
        </div>

        <!-- Quick Action Buttons -->
        <div class="quick-actions">
          <button class="action-btn primary-action" (click)="bookService()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            <span>Book Service</span>
          </button>
          <button class="action-btn" (click)="callWorkshop()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
              />
            </svg>
            <span>Call</span>
          </button>
          <button class="action-btn" (click)="openMaps()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21" />
              <line x1="9" y1="3" x2="9" y2="18" />
              <line x1="15" y1="6" x2="15" y2="21" />
            </svg>
            <span>Directions</span>
          </button>
          <button class="action-btn" (click)="emailWorkshop()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
              />
              <polyline points="22,6 12,13 2,6" />
            </svg>
            <span>Email</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Tab Navigation -->
    <section class="tabs-section">
      <div class="tabs-container">
        <nav class="tabs-nav">
          <button
            class="tab-btn"
            [class.active]="activeTab === 'overview'"
            (click)="setActiveTab('overview')"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="M12 16v-4" />
              <path d="M12 8h.01" />
            </svg>
            <span>Overview</span>
          </button>
          <button
            class="tab-btn"
            [class.active]="activeTab === 'services'"
            (click)="setActiveTab('services')"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
              />
            </svg>
            <span>Services</span>
            <span class="tab-count" *ngIf="workshopServices.length">{{
              workshopServices.length
            }}</span>
          </button>
          <button
            class="tab-btn"
            [class.active]="activeTab === 'reviews'"
            (click)="setActiveTab('reviews')"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
              />
            </svg>
            <span>Reviews</span>
            <span class="tab-count">{{ workshop.reviewCount }}</span>
          </button>
          <button
            class="tab-btn"
            [class.active]="activeTab === 'gallery'"
            (click)="setActiveTab('gallery')"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
              <circle cx="8.5" cy="8.5" r="1.5" />
              <polyline points="21 15 16 10 5 21" />
            </svg>
            <span>Gallery</span>
            <span class="tab-count" *ngIf="workshop.gallery.length">{{
              workshop.gallery.length
            }}</span>
          </button>
        </nav>
      </div>
    </section>

    <!-- Tab Content -->
    <section class="content-section">
      <div class="content-container">
        <!-- Overview Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'overview'">
          <div class="overview-grid">
            <!-- About Card -->
            <div class="info-card about-card">
              <div class="card-header">
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <path d="M12 16v-4" />
                  <path d="M12 8h.01" />
                </svg>
                <h3>About This Workshop</h3>
              </div>
              <div class="card-body">
                <p class="description-text">{{ workshop.description }}</p>

                <!-- Key Highlights -->
                <div class="highlights-grid">
                  <div class="highlight-item">
                    <div class="highlight-icon">
                      <svg
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                      </svg>
                    </div>
                    <div class="highlight-info">
                      <span class="highlight-value">{{
                        workshop.numbersOfTechnicians || 'N/A'
                      }}</span>
                      <span class="highlight-label">Technicians</span>
                    </div>
                  </div>
                  <div class="highlight-item">
                    <div class="highlight-icon">
                      <svg
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
                        />
                      </svg>
                    </div>
                    <div class="highlight-info">
                      <span class="highlight-value">{{ workshopServices.length || 0 }}</span>
                      <span class="highlight-label">Services Offered</span>
                    </div>
                  </div>
                  <div class="highlight-item">
                    <div class="highlight-icon">
                      <svg
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                        />
                      </svg>
                    </div>
                    <div class="highlight-info">
                      <span class="highlight-value">{{ workshop.rating.toFixed(1) }}</span>
                      <span class="highlight-label">Rating</span>
                    </div>
                  </div>
                  <div class="highlight-item" *ngIf="workshop.verificationStatus === 'Verified'">
                    <div class="highlight-icon success">
                      <svg
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                      </svg>
                    </div>
                    <div class="highlight-info">
                      <span class="highlight-value">Verified</span>
                      <span class="highlight-label">Workshop</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Contact & Location Card -->
            <div class="info-card contact-card">
              <div class="card-header">
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                  <circle cx="12" cy="10" r="3" />
                </svg>
                <h3>Contact & Location</h3>
              </div>
              <div class="card-body">
                <div class="contact-list">
                  <div class="contact-item" (click)="openMaps()">
                    <div class="contact-icon location">
                      <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                        <circle cx="12" cy="10" r="3" />
                      </svg>
                    </div>
                    <div class="contact-info">
                      <span class="contact-label">Location</span>
                      <span class="contact-value"
                        >{{ workshop.city }}, {{ workshop.governorate }},
                        {{ workshop.country }}</span
                      >
                    </div>
                    <svg
                      class="contact-arrow"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="9 18 15 12 9 6" />
                    </svg>
                  </div>

                  <div class="contact-item" *ngIf="workshop.phone" (click)="callWorkshop()">
                    <div class="contact-icon phone">
                      <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72"
                        />
                      </svg>
                    </div>
                    <div class="contact-info">
                      <span class="contact-label">Phone</span>
                      <span class="contact-value">{{ workshop.phone }}</span>
                    </div>
                    <svg
                      class="contact-arrow"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="9 18 15 12 9 6" />
                    </svg>
                  </div>
                </div>

                <!-- Mini Map Preview -->
                <div class="map-preview" (click)="openMaps()">
                  <div class="map-placeholder">
                    <svg
                      width="32"
                      height="32"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.5"
                    >
                      <polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21" />
                      <line x1="9" y1="3" x2="9" y2="18" />
                      <line x1="15" y1="6" x2="15" y2="21" />
                    </svg>
                    <span>View on Google Maps</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Working Hours Card -->
            <div class="info-card hours-card">
              <div class="card-header">
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <polyline points="12 6 12 12 16 14" />
                </svg>
                <h3>Working Hours</h3>
                <span class="today-hours" *ngIf="getTodayHours()">
                  Today: {{ getTodayHours() }}
                </span>
              </div>
              <div class="card-body">
                <div class="hours-list">
                  <div
                    class="hours-item"
                    *ngFor="let hour of workshop.workingHours"
                    [class.today]="isToday(hour.day)"
                    [class.closed]="hour.isClosed"
                  >
                    <span class="day-name">
                      {{ hour.day }}
                      <span class="today-badge" *ngIf="isToday(hour.day)">Today</span>
                    </span>
                    <span class="day-hours" *ngIf="!hour.isClosed"
                      >{{ hour.openTime }} - {{ hour.closeTime }}</span
                    >
                    <span class="day-hours closed" *ngIf="hour.isClosed">Closed</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Amenities Card -->
            <div
              class="info-card amenities-card"
              *ngIf="workshop.amenities && workshop.amenities.length > 0"
            >
              <div class="card-header">
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                  <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
                <h3>Amenities & Features</h3>
              </div>
              <div class="card-body">
                <div class="amenities-grid">
                  <div class="amenity-item" *ngFor="let amenity of workshop.amenities">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="20 6 9 17 4 12" />
                    </svg>
                    <span>{{ amenity }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Services Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'services'">
          <div class="services-section">
            <!-- Services Header -->
            <div class="section-header">
              <div class="header-info">
                <h2>Available Services</h2>
                <p>{{ workshopServices.length }} services offered at this workshop</p>
              </div>
              <!-- Removed Book Now button -->
              <!-- <button class="book-now-btn" (click)="bookService()">
                <svg ...> ... </svg> Book Now </button> -->
            </div>

            <!-- Services Grid -->
            <div class="services-grid">
              <div
                class="service-card clickable"
                *ngFor="let service of workshopServices; let i = index"
                [style.animation-delay]="i * 0.05 + 's'"
                (click)="bookService(service)"
                title="Click to book this service"
              >
                <div class="service-header">
                  <div class="service-icon">
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
                      />
                    </svg>
                  </div>
                  <span class="service-name">{{ service.serviceName }}</span>
                </div>
                <p class="service-description" *ngIf="service.serviceDescription">
                  {{ service.serviceDescription }}
                </p>
                <div class="service-details">
                  <span class="service-price">{{ formatServicePrice(service) }}</span>
                  <span class="service-duration">
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <circle cx="12" cy="12" r="10" />
                      <polyline points="12 6 12 12 16 14" />
                    </svg>
                    {{ formatServiceDuration(service.duration) }}
                  </span>
                  <span class="service-origin" *ngIf="service.origin">{{ service.origin }}</span>
                </div>
                <!-- Move Book button to bottom right -->
                <div class="service-actions">
                  <button
                    class="book-service-btn"
                    (click)="bookService(service); $event.stopPropagation()"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                      <line x1="16" y1="2" x2="16" y2="6" />
                      <line x1="8" y1="2" x2="8" y2="6" />
                    </svg>
                    Book
                  </button>
                </div>
              </div>
            </div>

            <!-- Pagination Controls -->
            <div class="pagination-wrapper" *ngIf="servicesTotalRecords > servicesPageSize">
              <div class="pagination-container">
                <div class="pagination-info">
                  <span class="showing-text">
                    Showing <strong>{{ getServicesShowingStart() }}</strong> -
                    <strong>{{ getServicesShowingEnd() }}</strong> of
                    <strong>{{ servicesTotalRecords }}</strong> services
                  </span>
                </div>
                <div class="pagination-nav">
                  <button
                    title="First Page"
                    class="pagination-btn nav-btn"
                    (click)="firstServicesPage()"
                    [disabled]="servicesPageNumber === 1"
                  >
                    <!-- first icon -->
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="11 17 6 12 11 7"></polyline>
                      <polyline points="18 17 13 12 18 7"></polyline>
                    </svg>
                  </button>
                  <button
                    title="Previous Page"
                    class="pagination-btn nav-btn"
                    (click)="prevServicesPage()"
                    [disabled]="servicesPageNumber === 1"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M15 18l-6-6 6-6"></path>
                    </svg>
                  </button>
                  <div class="pagination-pages">
                    <button
                      *ngFor="let p of getServicesPages()"
                      class="page-btn"
                      [class.active]="p === servicesPageNumber"
                      (click)="onServicesPageClick(p)"
                      [disabled]="p === '...'"
                    >
                      <span *ngIf="p === '...'" class="page-ellipsis">...</span>
                      <span *ngIf="p !== '...'">{{ p }}</span>
                    </button>
                  </div>
                  <button
                    title="Next Page"
                    class="pagination-btn nav-btn"
                    (click)="nextServicesPage()"
                    [disabled]="servicesPageNumber >= servicesTotalPages"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M9 18l6-6-6-6"></path>
                    </svg>
                  </button>
                  <button
                    title="Last Page"
                    class="pagination-btn nav-btn"
                    (click)="lastServicesPage()"
                    [disabled]="servicesPageNumber >= servicesTotalPages"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="13 17 18 12 13 7"></polyline>
                      <polyline points="6 17 11 12 6 7"></polyline>
                    </svg>
                  </button>
                </div>
                <div class="page-size-selector">
                  <label>Per page:</label>
                  <select
                    class=""
                    [ngModel]="servicesPageSize"
                    (ngModelChange)="changeServicesPageSize($event)"
                  >
                    <option [value]="3">3</option>
                    <option [value]="6">6</option>
                    <option [value]="9">9</option>
                    <option [value]="15">15</option>
                    <option [value]="30">30</option>
                    <option [value]="60">60</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Book CTA -->
            <div class="services-cta">
              <div class="cta-content">
                <h3>Ready to book a service?</h3>
                <p>Schedule your appointment with {{ workshop.name }} today</p>
              </div>
              <button class="cta-btn" (click)="bookService()">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                  <line x1="16" y1="2" x2="16" y2="6" />
                  <line x1="8" y1="2" x2="8" y2="6" />
                </svg>
                Schedule Appointment
              </button>
            </div>
          </div>
        </div>

        <!-- Reviews Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'reviews'">
          <div class="reviews-section">
            <!-- Reviews Summary - App Store Style -->
            <div class="reviews-summary">
              <div class="summary-left">
                <div class="big-rating-number">{{ workshop.rating.toFixed(1) }}</div>
                <div class="rating-stars-row">
                  <ng-container *ngFor="let star of getStarArray(workshop.rating)">
                    <svg
                      *ngIf="star === 1"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="#f59e0b"
                    >
                      <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      />
                    </svg>
                    <svg *ngIf="star === 0.5" width="18" height="18" viewBox="0 0 24 24">
                      <defs>
                        <linearGradient id="halfStarSum">
                          <stop offset="50%" stop-color="#f59e0b" />
                          <stop offset="50%" stop-color="#e2e8f0" />
                        </linearGradient>
                      </defs>
                      <path
                        fill="url(#halfStarSum)"
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      />
                    </svg>
                    <svg
                      *ngIf="star === 0"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="#e2e8f0"
                    >
                      <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      />
                    </svg>
                  </ng-container>
                </div>
                <div class="rating-meta">
                  <span class="rating-value">{{ workshop.rating.toFixed(1) }}</span>
                  <span class="rating-separator">•</span>
                  <span class="ratings-count">{{ workshop.reviewCount }} Ratings</span>
                  <a class="reviews-link" (click)="scrollToReviews()"
                    >{{ workshop.reviews.length }} reviews</a
                  >
                </div>
              </div>

              <div class="summary-right">
                <div class="rating-bars-list">
                  <div class="rating-bar-row" *ngFor="let bar of ratingBars">
                    <div class="bar-track-bg">
                      <div class="bar-fill-orange" [style.width.%]="bar.percentage"></div>
                    </div>
                    <span class="bar-star-label">{{ bar.stars }}.0</span>
                    <svg
                      class="bar-star-icon"
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="#f59e0b"
                    >
                      <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      />
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <!-- Reviews List -->
            <div class="reviews-list">
              <div
                class="review-card"
                *ngFor="let review of workshop.reviews; let i = index"
                [style.animation-delay]="i * 0.1 + 's'"
              >
                <div class="review-header">
                  <div class="reviewer-info">
                    <div class="reviewer-avatar">
                      <img
                        *ngIf="review.userAvatar"
                        [src]="review.userAvatar"
                        [alt]="review.userName"
                      />
                      <span *ngIf="!review.userAvatar">{{ review.userName.charAt(0) }}</span>
                    </div>
                    <div class="reviewer-details">
                      <span class="reviewer-name">{{ review.userName }}</span>
                      <span class="review-date">{{ review.date | date : 'mediumDate' }}</span>
                    </div>
                  </div>
                  <div class="review-rating">
                    <ng-container *ngFor="let star of getStarArray(review.rating)">
                      <svg
                        *ngIf="star === 1"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="#fbbf24"
                        stroke="#fbbf24"
                      >
                        <path
                          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                        />
                      </svg>
                      <svg
                        *ngIf="star === 0"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="#e2e8f0"
                      >
                        <path
                          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                        />
                      </svg>
                    </ng-container>
                  </div>
                </div>
                <p class="review-comment">{{ review.comment }}</p>
              </div>
            </div>

            <!-- Empty Reviews -->
            <div class="empty-reviews" *ngIf="!workshop.reviews || workshop.reviews.length === 0">
              <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1"
              >
                <path
                  d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                />
              </svg>
              <h3>No reviews yet</h3>
              <p>Be the first to review this workshop after your service!</p>
            </div>
          </div>
        </div>

        <!-- Gallery Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'gallery'">
          <div class="gallery-section">
            <div class="gallery-header">
              <h3>Gallery</h3>
              <p class="gallery-hint">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="12" y1="16" x2="12" y2="12" />
                  <line x1="12" y1="8" x2="12.01" y2="8" />
                </svg>
                Click any image to set it as the cover photo
              </p>
            </div>
            <div class="gallery-grid" *ngIf="workshop.gallery && workshop.gallery.length > 0">
              <div
                class="gallery-item"
                *ngFor="let image of workshop.gallery; let i = index"
                [class.active-cover]="currentHeroImage === image"
                [style.animation-delay]="i * 0.05 + 's'"
                (click)="setAsHeroImage(image)"
              >
                <img [src]="image" [alt]="'Gallery image ' + (i + 1)" />
                <div class="gallery-overlay">
                  <div class="overlay-actions">
                    <span class="set-cover-btn" *ngIf="currentHeroImage !== image">
                      <svg
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                        <circle cx="8.5" cy="8.5" r="1.5" />
                        <polyline points="21 15 16 10 5 21" />
                      </svg>
                      Set as Cover
                    </span>
                    <span class="current-cover-badge" *ngIf="currentHeroImage === image">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                      Current Cover
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Empty Gallery -->
            <div class="empty-gallery" *ngIf="!workshop.gallery || workshop.gallery.length === 0">
              <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                <circle cx="8.5" cy="8.5" r="1.5" />
                <polyline points="21 15 16 10 5 21" />
              </svg>
              <h3>No gallery images</h3>
              <p>This workshop hasn't uploaded any gallery images yet.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Floating Book Button (Mobile) -->
    <div class="floating-book-btn" (click)="bookService()">
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
        <line x1="16" y1="2" x2="16" y2="6" />
        <line x1="8" y1="2" x2="8" y2="6" />
      </svg>
      <span>Book Now</span>
    </div>
  </div>

  <!-- Image Modal -->
  <div class="image-modal" *ngIf="selectedImage" (click)="closeImageModal()">
    <button class="modal-close" (click)="closeImageModal()">
      <svg
        width="28"
        height="28"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <line x1="18" y1="6" x2="6" y2="18" />
        <line x1="6" y1="6" x2="18" y2="18" />
      </svg>
    </button>
    <div class="modal-content" (click)="$event.stopPropagation()">
      <img [src]="selectedImage" alt="Full size image" />
    </div>
    <div class="modal-nav" *ngIf="workshop && workshop.gallery && workshop.gallery.length > 1">
      <button class="nav-prev" (click)="previousImage(); $event.stopPropagation()">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="15 18 9 12 15 6" />
        </svg>
      </button>
      <button class="nav-next" (click)="nextImage(); $event.stopPropagation()">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="9 18 15 12 9 6" />
        </svg>
      </button>
    </div>
  </div>
</div>
