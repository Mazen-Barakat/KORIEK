<div class="workshop-details-page">
  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Loading workshop details...</p>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="!isLoading && errorMessage">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <circle cx="12" cy="12" r="10"/>
      <line x1="12" y1="8" x2="12" y2="12"/>
      <line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    <h3>{{ errorMessage }}</h3>
    <button class="retry-btn" (click)="loadWorkshopDetails()">Try Again</button>
  </div>

  <!-- Workshop Content -->
  <div class="workshop-content" *ngIf="!isLoading && workshop">
    <!-- Hero Section with Cover Image -->
    <div class="hero-section">
      <div class="hero-overlay"></div>
      <img *ngIf="workshop.coverImageUrl" [src]="workshop.coverImageUrl" [alt]="workshop.name" class="hero-image"/>
      <div class="hero-placeholder" *ngIf="!workshop.coverImageUrl">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <path d="M3 21h18"/><path d="M5 21V7l8-4v18"/><path d="M19 21V11l-6-4"/>
        </svg>
      </div>
      
      <!-- Back Button -->
      <button class="back-btn" (click)="goBack()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5"/><path d="m12 19-7-7 7-7"/>
        </svg>
        <span>Back</span>
      </button>
      
      <!-- Status Badge -->
      <div class="hero-status" [class.open]="workshop.isOpen" [class.closed]="!workshop.isOpen">
        <span class="status-dot"></span>
        {{ workshop.isOpen ? 'Open Now' : 'Closed' }}
      </div>
    </div>

    <!-- Main Container -->
    <div class="details-container">
      <!-- Workshop Header Card -->
      <div class="workshop-header-card">
        <div class="header-top">
          <div class="workshop-logo">
            <img *ngIf="workshop.logoImageUrl" [src]="workshop.logoImageUrl" [alt]="workshop.name"/>
            <span *ngIf="!workshop.logoImageUrl" class="logo-initials">{{ getInitials(workshop.name) }}</span>
          </div>
          <div class="workshop-main-info">
            <h1 class="workshop-name">
              {{ workshop.name }}
              <svg *ngIf="workshop.verificationStatus === 'Verified'" class="verified-badge" width="24" height="24" viewBox="0 0 24 24" fill="#3b82f6">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </h1>
            <div class="workshop-meta">
              <span class="workshop-type">{{ workshop.workShopType }}</span>
              <span class="price-range">{{ getPriceLabel(workshop.priceRange) }}</span>
            </div>
            
            <!-- Rating -->
            <div class="rating-section">
              <div class="stars">
                <svg *ngFor="let star of getStarArray(workshop.rating)" width="18" height="18" viewBox="0 0 24 24" [attr.fill]="star === 1 ? '#fbbf24' : 'none'" stroke="#fbbf24" stroke-width="2">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
              </div>
              <span class="rating-value">{{ workshop.rating.toFixed(1) }}</span>
              <span class="review-count">({{ workshop.reviewCount }} reviews)</span>
            </div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions">
          <button class="action-btn primary" (click)="bookService()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            Book Service
          </button>
          <button class="action-btn" (click)="callWorkshop()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
            </svg>
            Call
          </button>
          <button class="action-btn" (click)="emailWorkshop()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            Email
          </button>
          <button class="action-btn" (click)="openMaps()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
            </svg>
            Directions
          </button>
        </div>
      </div>

      <!-- Navigation Tabs -->
      <div class="tabs-nav">
        <button class="tab-btn" [class.active]="activeTab === 'overview'" (click)="setActiveTab('overview')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          Overview
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'services'" (click)="setActiveTab('services')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
          </svg>
          Services
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'reviews'" (click)="setActiveTab('reviews')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
          Reviews
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'gallery'" (click)="setActiveTab('gallery')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21 15 16 10 5 21"/>
          </svg>
          Gallery
        </button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Overview Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'overview'">
          <div class="content-grid">
            <!-- About Section -->
            <div class="info-card">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
                About
              </h3>
              <p class="description">{{ workshop.description }}</p>
            </div>

            <!-- Contact Info -->
            <div class="info-card">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
                </svg>
                Contact & Location
              </h3>
              <div class="contact-list">
                <div class="contact-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
                  </svg>
                  <span>{{ workshop.address }}, {{ workshop.city }}</span>
                </div>
                <div class="contact-item" *ngIf="workshop.phone">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72"/>
                  </svg>
                  <a href="tel:{{ workshop.phone }}">{{ workshop.phone }}</a>
                </div>
                <div class="contact-item" *ngIf="workshop.email">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                    <polyline points="22,6 12,13 2,6"/>
                  </svg>
                  <a href="mailto:{{ workshop.email }}">{{ workshop.email }}</a>
                </div>
              </div>
            </div>

            <!-- Working Hours -->
            <div class="info-card">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                </svg>
                Working Hours
              </h3>
              <div class="hours-list">
                <div class="hours-item" *ngFor="let hour of workshop.workingHours" [class.closed]="hour.isClosed">
                  <span class="day">{{ hour.day }}</span>
                  <span class="time" *ngIf="!hour.isClosed">{{ hour.openTime }} - {{ hour.closeTime }}</span>
                  <span class="time closed-text" *ngIf="hour.isClosed">Closed</span>
                </div>
              </div>
            </div>

            <!-- Amenities -->
            <div class="info-card" *ngIf="workshop.amenities && workshop.amenities.length > 0">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                Amenities
              </h3>
              <div class="amenities-grid">
                <div class="amenity-item" *ngFor="let amenity of workshop.amenities">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                  {{ amenity }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Services Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'services'">
          <div class="services-grid">
            <div class="service-card" *ngFor="let service of workshop.services">
              <div class="service-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                </svg>
              </div>
              <span class="service-name">{{ service }}</span>
            </div>
          </div>
          
          <div class="book-cta">
            <p>Ready to book a service?</p>
            <button class="book-btn" (click)="bookService()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
              Book Now
            </button>
          </div>
        </div>

        <!-- Reviews Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'reviews'">
          <div class="reviews-summary">
            <div class="overall-rating">
              <span class="big-rating">{{ workshop.rating.toFixed(1) }}</span>
              <div class="stars-large">
                <svg *ngFor="let star of getStarArray(workshop.rating)" width="24" height="24" viewBox="0 0 24 24" [attr.fill]="star === 1 ? '#fbbf24' : 'none'" stroke="#fbbf24" stroke-width="2">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
              </div>
              <span class="total-reviews">Based on {{ workshop.reviewCount }} reviews</span>
            </div>
          </div>

          <div class="reviews-list">
            <div class="review-card" *ngFor="let review of workshop.reviews">
              <div class="review-header">
                <div class="reviewer-avatar">
                  <span>{{ review.userName.charAt(0) }}</span>
                </div>
                <div class="reviewer-info">
                  <span class="reviewer-name">{{ review.userName }}</span>
                  <span class="review-date">{{ review.date }}</span>
                </div>
                <div class="review-rating">
                  <svg *ngFor="let star of getStarArray(review.rating)" width="14" height="14" viewBox="0 0 24 24" [attr.fill]="star === 1 ? '#fbbf24' : 'none'" stroke="#fbbf24" stroke-width="2">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                </div>
              </div>
              <p class="review-comment">{{ review.comment }}</p>
              <span class="review-car" *ngIf="review.carModel">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M5 17h14M5 17a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2M7 21l2-4m8 4l-2-4"/>
                </svg>
                {{ review.carModel }}
              </span>
            </div>
          </div>
        </div>

        <!-- Gallery Tab -->
        <div class="tab-panel" *ngIf="activeTab === 'gallery'">
          <div class="gallery-grid" *ngIf="workshop.gallery && workshop.gallery.length > 0">
            <div class="gallery-item" *ngFor="let image of workshop.gallery" (click)="openImageModal(image)">
              <img [src]="image" alt="Workshop gallery image"/>
              <div class="gallery-overlay">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
                  <line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/>
                </svg>
              </div>
            </div>
          </div>
          <div class="empty-gallery" *ngIf="!workshop.gallery || workshop.gallery.length === 0">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/>
              <polyline points="21 15 16 10 5 21"/>
            </svg>
            <p>No gallery images available</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Modal -->
  <div class="image-modal" *ngIf="selectedImage" (click)="closeImageModal()">
    <button class="modal-close" (click)="closeImageModal()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
    <img [src]="selectedImage" alt="Full size image" (click)="$event.stopPropagation()"/>
  </div>
</div>
